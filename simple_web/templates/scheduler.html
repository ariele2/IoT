{% extends "base.html" %}

{% block content %}

<h1 align="center" class="mt-3 mb-5"> Scheduler </h1>
<!--- should loop here on the items in the database and show them in the table --->
<div class="continer-md-75">
    <table class="table align-middle">
        <thead>
          <tr class="table-dark">
            <th scope="col">#</th>
            <th scope="col">Start date</th>
            <th scope="col">End date</th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody>
          {% for item in scheduler_data %}
          <tr>
            <th scope="row">{{loop.index}}</th>
            <td>{{item[1]}}</td>
            <td>{{item[2]}}</td>
            <td> <a class="btn btn-sm btn-primary-outline" type="button" href="/deleteSchedule?id={{item[0]}}" role="button"> <i class="bi bi-trash"></i> </a> </td>
          </tr>
          {% endfor %}
          <tr class="collapse" id="collapseAdd">
            <form class="form-inline" action="" method='POST' name="myform">
                {{ form.csrt_token }}
                <td></td>
                <div class="input-group">
                  <td id="datetimepicker1" data-td-target-input='nearest' data-td-target-toggle='nearest'>
                    <span data-td-target='#datetimepicker1' data-td-toggle='datetimepicker'>
                      {{form.startdate(class_='form-control schedulePicker', id='datetimepicker1Input', type='text', **{'data-td-target':'#datetimepicker1'})}} {{form.hidden_tag()}}
                      <i class="bi bi-calendar"></i>
                    </span>
                  </td>
                </div>
                <div class="input-group">
                  <td id="datetimepicker2" data-td-target-input='nearest' data-td-target-toggle='nearest'>
                    <span data-td-target='#datetimepicker2' data-td-toggle='datetimepicker'>
                      {{form.enddate(class_='form-control schedulePicker', id='datetimepicker2Input', type='text', **{'data-td-target':'#datetimepicker2'})}} {{form.hidden_tag()}}
                      <i class="bi bi-calendar"></i>
                    </span>
                  </td>
                </div>
                {% if form.errors %}
                  {{ form.errors }}
                {% endif %}
                <td>
                  {{form.submit(class_="btn btn-sm btn-dark", id="addScheduleBtn")}} {{form.hidden_tag()}}
                </td>
            </form>
          </tr>
        </tbody>
      </table>
      <div class="row justify-content-md-left mt-2">
        <a class="btn btn-sm btn-primary-outline" type="button" data-bs-toggle="collapse" href="#collapseAdd" role="button" aria-expanded="false" aria-controls="collapseAdd">
            <i class="bi bi-plus-circle"></i>
        </a>
      </div>
</div>

{% endblock %}

{% block script %}
<script>
    const td1 = new tempusDominus.TempusDominus(document.getElementById('datetimepicker1'), {
      "display":{
        "components":{
          "useTwentyfourHour":true, 
          "seconds":true
        }
      }
    });
    td1.dates.formatInput = function(date) { {return moment(date).format('DD-MM-YY HH:mm:ss') } }
    const td2 = new tempusDominus.TempusDominus(document.getElementById('datetimepicker2'), {
      "display":{
        "components":{
          "useTwentyfourHour":true, 
          "seconds":true
        }
      }
    });
    td2.dates.formatInput = function(date) { {return moment(date).format('DD-MM-YY HH:mm:ss') } }
</script>
{% endblock %}